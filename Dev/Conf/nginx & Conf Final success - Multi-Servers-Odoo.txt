1- Prepaar Domains & website names: name server:
===================================================================
TO ADD DOMAIN & SUBDOMAIN NAME INSTEAD OD IP ADDRESS TO ODOO SERVER:
===================================================================

1- Login to your host
2- Go to domains
3- Go to DNS/Nameservers
4- in the top of screen search for DNS A record
5- Change as below
	Type	Name	Priority	Content/IP			TTL
	A	@	0		195.35.28.250		no change

To ADD SUBDOMAINS:
	Type	Name	Priority	Content/IP			TTL
	A	alus	0		195.35.28.250			100	No Need
	CNAME	www.alus0		trend-ai.tech			100	No Need
---------------------------------------------------------------------------------------------------------------------

2- Change config file
----------------------
ADD THE FOLLOWING LINE:
----------------------
ps aux || grep odoo17
cd /opt/odoo17/tryitfree/odoo
sudo nano /etc/odoo17.conf
worker = 4	=====>>>>  Rule of thumb : (#CPU * 2) + 1 & Cron workers need CPU & 1 worker ~= 6 concurrent users
proxy_mode = True
gevent_port = 8073


--------------alusys.conf----------------
[options]
db_host = False
db_port = False
db_user = False
db_password = False
addons_path = /opt/alusys/odoo/addons
log_file = /var/log/alusys/alusys.log
default_productivity_apps = True
xmlrpc_port = 8077
admin_passwd = $pbkdf2-sha512$600000$AwBASKlV6l2L0dp77x0DYA$vhc88ikLdC.xfCDlxq75DFiVV1lU6wjU4qXVGiV170wU36spFkbQVGc7BhrKClDLhxg8AaLk71pnaAjT0Gmi>
workers = 4
proxy_mode = True
/gevent_port = 8073

--------------alusys copy for odoo16.conf----------------
[options]
db_host = False
db_port = False
db_user = False
db_password = False
addons_path = /opt/odoo16/odoo/addons,/opt/odoo16/addons
log_file = /var/log/odoo/odoo16.log
default_productivity_apps = True
xmlrpc_port = 8069
admin_passwd = 123456
workers = 4
proxy_mode = True
/gevent_port = 8072

sudo service odoo17 restart

----------------------------------------------------------------------------------------------------------------------

3- Install nginx & prepare nginx config file:
============================================
/sudo apt install nginx -y
/sudo apt install certbot python3-certbot-nginx
sudo nano /etc/odoo17.conf
sudo nano /etc/alus.conf

ls -la /etc/nginx/sites-available
sudo nano /etc/nginx/sites-available/alus.conf	====>>> RECOMMENDED ANYWAY To Create nginx File if NOT EXISTS
========================================================
Copy this and paste into file /etc/nginx/sites-available
========================================================

alus.trend-ai.tech nginx file alus.conf
##################################################################
#odoo 17.0 server
upstream alus {
server 127.0.0.1:8087;
}
upstream aluschat {
server 127.0.0.1:8072;
}


server {
listen 80;
server_name server_name alus.trend-ai.tech www.alus.trend-ai.tech;

proxy_read_timeout 720s;
proxy_connect_timeout 720s;
proxy_send_timeout 720s;


# Add Headers for odoo proxy mode
proxy_set_header X-Forwarded-Host $host;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto $scheme;
proxy_set_header X-Real-IP $remote_addr;

# log
access_log /var/log/nginx/alus.access.log;
error_log /var/log/nginx/alus.error.log;

# Redirect requests to odoo backend server
location / {
proxy_redirect off;
proxy_pass http://alus;
}
location /longpolling {
proxy_pass http://aluschat;
}

# common gzip
gzip_types text/css text/less text/plain text/xml application/xml application/json application/javascript;
gzip on;


client_body_in_file_only clean;
client_body_buffer_size 32K;
client_max_body_size 500M;
sendfile on;
send_timeout 600s;
keepalive_timeout 300;
}
#####################################################â€ƒ
sudo ln -s /etc/nginx/sites-available/alus.conf /etc/nginx/sites-enabled/alus.conf
ls -la /etc/nginx/sites-available
ls -la /etc/nginx/sites-enabled
-------------------------------------------------------------------------------------------------------------------------------------------------------

sudo nano /etc/nginx/sites-available/odoo17.conf

Prepare alus.trend-ai.tech nginx file alus.conf for odoo16.conf
##################################################################
#odoo server
upstream odoo17 {
server 127.0.0.1:8069;
}
upstream odoo17chat {
server 127.0.0.1:8072;
}


server {
server_name odoo17.trend-ai.tech www.odoo17.trend-ai.tech;
proxy_read_timeout 720s;
proxy_connect_timeout 720s;
proxy_send_timeout 720s;


# Add Headers for odoo proxy mode
proxy_set_header X-Forwarded-Host $host;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto $scheme;
proxy_set_header X-Real-IP $remote_addr;

# log
access_log /var/log/nginx/odoo17.access.log;
error_log /var/log/nginx/odoo17.error.log;

# Redirect requests to odoo backend server
location / {
proxy_redirect off;
proxy_pass http://odoo17;
}
location /longpolling {
proxy_pass http://odoo17chat;
}

# common gzip
gzip_types text/css text/less text/plain text/xml application/xml application/json application/javascript;
gzip on;


client_body_in_file_only clean;
client_body_buffer_size 32K;
client_max_body_size 500M;
sendfile on;
send_timeout 600s;
keepalive_timeout 300;
}
#####################################################
/sudo chmod 755 alusys.conf
/sudo chown alusys:root odoo16.conf
sudo ln -s /etc/nginx/sites-available/odoo17.conf /etc/nginx/sites-enabled/odoo17.conf

ls -la /etc/nginx/sites-available 	===>>> to insure odoo17.conf file created
ls -la /etc/nginx/sites-enabled		==========>>> you will find a copy of odoo17.conf file

--------------------4- FINALLY RUN NGINX WEB SERVER-------------------------------------------------------
===================================================================================================================
TO RUN MULTI-PROCCESSING WORKERS IN ODOO SERVER
===================================================================================================================

then ===>>> RUN

sudo nginx -t
sudo systemctl reload nginx
sudo service apache2 status
sudo service apache2 stop
sudo service apache2 status

sudo service nginx status
sudo service nginx stop
sudo service nginx status
sudo service nginx start
sudo service nginx status
sudo service nginx restart
sudo service nginx status

sudo service odoo17 status
sudo service odoo17 stop
sudo service odoo17 status
sudo service odoo17 start
sudo service odoo17 status
sudo service odoo17 restart
sudo service alus restart
---------------------------------5- TEST NGINX LOG FILE--------------------------------------------------
sudo tail -f /var/log/nginx/alus.access.log
sudo tail -f /var/log/nginx/alus.error.log
sudo tail -f /var/log/nginx/odoo17.access.log
sudo tail -f /var/log/nginx/odoo17.error.log

*******************************************************************************************************************************************************************************************
===================================================================================================================
6- TO ADD SSL CERTIFICATE TO YOUR DOMAIN FOR ODOO SERVER
===================================================================================================================
MAKE SURE:
/Make shore to change the port: "server 127.0.0.1:8087;" & the server_name: "server_name server_name alus.trend-ai.tech www.alus.trend-ai.tech;"
/sudo nano /etc/nginx/sites-enabled/odoo17.conf
/Change the server name as below
/server_name odoo17.trend-ai.tech www.odoo17.trend-ai.tech;
----------------------------------------------------------------------------
If Certbot Already Installed & you wand to delete certificates
sudo certbot delete
----------------------------------------------------------------------------
if not
source odoo_env/bin/activate		==>> I'm no sure that you have to activate vertual environment or not
sudo apt remove python3-cffi		==>>> If it was already installed
sudo python3 -m pip install cffi	==>>> Install it to activate ssl
sudo nginx -t
sudo systemctl reload nginx
------------------------------------------------------------------------------
sudo certbot		===>>>> Automatically Chechs the enabled websites and give you options which one you want to install certificate/s
Required Email: trenders.intl@gmail.com

===================================================================================================================
7- RENEW SSL CERTIFICATE TO YOUR DOMAIN FOR ODOO SERVER
===================================================================================================================



===================================================================================================================
8- TO ENABLE FIREWALL ON YOUR DOMAIN FOR ODOO SERVER
===================================================================================================================

sudo ufw allow 'Nginx Full'
sudo ufw delete allow 'Nginx HTTP'

